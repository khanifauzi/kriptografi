<html>
  <head>
    <title>Kriptografi</title>
    <style>
      *{
        font-family: helvetica;
      }
      .wrapper{
        width: 50%;
        margin: 0 auto 50px;
        overflow: hidden;
      }
      .text-center{
        text-align: center;
      }
      .centering{
        margin: 10px auto 30px;
        width: 80%;
        text-align: center;
      }
      .matrik{
        width: 40px;
      }
      table{
        width: 80%;
        margin: 0 auto;
        border: collapse;
      }
      table, td, th{
        border: 2px solid #eee;
      }
      #transposisi, td, th{
        border: none;
      }
      #transposisi td{
        text-align: center;
      }
      #add1 input, #add2 input{
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <h1 class="text-center">Enkripsi dan dekripsi Algoritma Vigenere</h1>
      <div class="centering">
        <form method="post" name="formEncryptVigenere" onsubmit="encryptVigenere(); return false;">
          <input type="text" name="plainVigenere" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="plaintext" required> -
          <input type="text" name="keyVigenere" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="key" required>
          <button type="submit">Encrypt</button>
        </form>
        <div>Hasil enkripsi vigenere : <span id="hasilEnkripsiVigenere"> - </span></div>
      </div>
      <div class="centering">
        <form method="post" name="formDecryptVigenere" onsubmit="decryptVigenere(); return false;">
          <input type="text" name="cipherVigenere" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="ciphertext" required> -
          <input type="text" name="keyVigenere" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="key" required>
          <button type="submit">Decrypt</button>
        </form>
        <div>Hasil dekripsi vigenere : <span id="hasilDekripsiVigenere"></span></div>
      </div>
    </div>

    <div class="wrapper">
      <h1 class="text-center">Enkripsi dan dekripsi Algoritma Hill Cipher</h1>
      <p class="text-center">Matrik 2x2</p>
      <div class="centering">
        <form method="post" name="formEncryptHillCipher" onsubmit="encryptHillCipher(); return false;">
          <input type="text" name="plainHillCipher" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="plaintext" required> -
          <input class="matrik" type="text" name="key00" pattern="[0-9]*">
          <input class="matrik" type="text" name="key01" pattern="[0-9]*">
          <input class="matrik" type="text" name="key10" pattern="[0-9]*">
          <input class="matrik" type="text" name="key11" pattern="[0-9]*">
          <button type="submit">Encrypt</button>
        </form>
        <div>Hasil enkripsi Hill Cipher : <span id="hasilEnkripsiHillCipher"> - </span></div>
      </div>
      <div class="centering">
        <form method="post" name="formDecryptHillCipher" onsubmit="decryptHillCipher(); return false;">
          <input type="text" name="cipherHillCipher" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="ciphertext" required> -
          <input class="matrik" type="text" name="key00" pattern="[0-9]*">
          <input class="matrik" type="text" name="key01" pattern="[0-9]*">
          <input class="matrik" type="text" name="key10" pattern="[0-9]*">
          <input class="matrik" type="text" name="key11" pattern="[0-9]*">
          <button type="submit">Decrypt</button>
        </form>
        <div>Hasil dekripsi Hill Cipher : <span id="hasilDekripsiHillCipher"> - </span></div>
      </div>
    </div>

    <div class="wrapper">
      <h1 class="text-center">Enkripsi dan dekripsi Algoritma Transposisi</h1>
      <div class="centering">
        <form method="post" name="formEncryptTransposisi" onsubmit="encryptTransposisi(); return false;">
          <table id="transposisi">
            <tr>
              <td>
                <input type="text" name="plainTransposisi" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="plaintext" required> -
                <input type="text" name="panjangKunci" style="text-transform: uppercase" pattern="[1-9]*" placeholder="Panjang kunci" required onblur='inputKunci(this.value,"add1")'>
              </td>
            </tr>
            <tr>
              <td id="add1"></td>
            </tr>
            <tr>
              <td><button type="submit">Encrypt</button></td>
            </tr>
          </table>
        </form>
        <div>Hasil enkripsi Transposisi : <span id="hasilEnkripsiTransposisi"> - </span></div>
      </div>
      <div class="centering">
        <form method="post" name="formDecryptTransposisi" onsubmit="decryptTransposisi(); return false;">
          <table id="transposisi">
            <tr>
              <td>
                <input type="text" name="cipherTransposisi" style="text-transform: uppercase" pattern="[a-zA-Z /s]*" placeholder="ciphertext" required> -
                <input type="text" name="panjangKunci" style="text-transform: uppercase" pattern="[1-9]*" placeholder="Panjang kunci" required onblur='inputKunci(this.value,"add2")'>
              </td>
            </tr>
            <tr>
              <td id="add2"></td>
            </tr>
            <tr>
              <td><button type="submit">Decrypt</button></td>
            </tr>
          </table>
        </form>
        <div>Hasil dekripsi Transposisi : <span id="hasilDekripsiTransposisi"> - </span></div>
      </div>
    </div>

    <div class="wrapper">
      <h1 class="text-center">Kelompok berapa ?</h1>
      <div class="centering">
        <table>
          <tr>
            <th>No.</th>
            <th>Nama</th>
            <th>NIM</th>
          </tr>
          <tr>
            <td class="text-center">1.</td>
            <td>Hafidh Aulia Wirandi</td>
            <td class="text-center">24010314130095</td>
          </tr>
          <tr>
            <td class="text-center">2.</td>
            <td>Khanif Fauzi Pambudi</td>
            <td class="text-center">24010314140094</td>
          </tr>
          <tr>
            <td class="text-center">3.</td>
            <td>Miftakhul Jannah</td>
            <td class="text-center">24010314120051</td>
          </tr>
          <tr>
            <td class="text-center">4.</td>
            <td>Muhammad Afif Aminulyo</td>
            <td class="text-center">24010314140120</td>
          </tr>
          <tr>
            <td class="text-center">5.</td>
            <td>Primanggala Surya MA</td>
            <td class="text-center">24010311130121</td>
          </tr>
        </table>
      </div>
    </div>

    <script>
    var alfabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var arrayAlfabet = alfabet.split('');
    function hurufKeAngka(huruf){
      var pos = arrayAlfabet.indexOf(huruf);
      return pos;
    }

    function encryptVigenere(){
      var hasil       = document.getElementById('hasilEnkripsiVigenere');
      var rawPlain    = document.forms["formEncryptVigenere"]["plainVigenere"].value.toUpperCase();
      var rawKey      = document.forms["formEncryptVigenere"]["keyVigenere"].value.toUpperCase();
      var plain       = rawPlain.split(' ').join('');
      var key         = rawKey.split(' ').join('');
      var plainLength = plain.length;
      var keyLength   = key.length;
      var arrayPlain  = plain.split('');
      var arrayKey    = key.split('');
      var cipher      = '';
      var encrypt;
      for(var i = 0; i < plainLength; i++){
        encrypt = (hurufKeAngka(arrayPlain[i]) + hurufKeAngka(arrayKey[i % keyLength])) % 26;
        encrypt = arrayAlfabet[encrypt];
        cipher  += encrypt;
      }
      hasil.innerHTML = cipher;
    }

    function decryptVigenere(){
      var hasil        = document.getElementById('hasilDekripsiVigenere');
      var rawCipher    = document.forms["formDecryptVigenere"]["cipherVigenere"].value.toUpperCase();
      var rawKey       = document.forms["formDecryptVigenere"]["keyVigenere"].value.toUpperCase();
      var cipher       = rawCipher.split(' ').join('');
      var key          = rawKey.split(' ').join('');
      var cipherLength = cipher.length;
      var keyLength    = key.length;
      var arrayCipher  = cipher.split('');
      var arrayKey     = key.split('');
      var plain        = '';
      var decrypt;
      for(var i = 0; i < cipherLength; i++){
        decrypt = (hurufKeAngka(arrayCipher[i]) - hurufKeAngka(arrayKey[i % keyLength])) % 26;
        if(decrypt >= 0){
          decrypt = arrayAlfabet[decrypt];
          plain  += decrypt;
        }
        else{
          while (decrypt <= -26) {
            decrypt += 26;
          }
          var pos = 26 + decrypt;
          decrypt = arrayAlfabet[pos];
          plain  += decrypt;
        }
      }
      hasil.innerHTML = plain;
    }

    function determinan(key){
      var determinan = (key[0][0] * key[1][1]) - (key[1][0] * key[0][1]);
      return determinan;
    }

    function inversMatrik(key){
      var det = determinan(key);
      var invers = [];
      invers.push([key[1][1]*(1/det),-key[0][1] * (1 / det)]);
      invers.push([-key[1][0] * (1 / det),key[0][0] * (1 / det)]);
      return invers;
    }

    function minus(angka){
      if(angka < 0){
        var modMinus = 26 - (Math.abs(angka) % 26);
        return modMinus;
      }
      else{
        return angka;
      }
    }

    function inversModulo(key){
      var det = determinan(key);
      var tes = true;
      var i = 1;
      var solidNumber;
      var hitung;
      while(tes){
        hitung = (1 + (26 * i)) / Math.abs(det);
        if(hitung % 1 == 0){
          tes = false;
          solidNumber = hitung;
          if(det < 0){
            solidNumber *= -1;
          }
          break;
        }
        i++;
      }
      var balik = [];
      balik.push([minus((key[1][1] * solidNumber) % 26),minus((-key[0][1] * solidNumber) % 26)]);
      balik.push([minus((-key[1][0] * solidNumber) % 26),minus((key[0][0] * solidNumber) % 26)]);
      return balik;
    }

    function perkalianMatrik(baris,matrika,matrikb){
      var hasilKali = [];
      var hasil = [];
      var i,j,k;
      for (i = 0; i < baris; i++) {
        for (j = 0; j < 2; j++) {
          a = 0;
          for (k = 0; k < 2; k++) {
            a += matrika[i][k] * matrikb[k][j];
          }
          hasil.push(a);
        }
      }
      for (i = 0; i < hasil.length; i++) {
        hasilKali.push([hasil[i],hasil[i+1]]);
        i++;
      }
      return hasilKali;
    }

    function cekMatrik(baris,key){
      var det = determinan(key);
      if (Math.abs(det) % baris == 1){
        return true;
      }
      else{
        return false;
      }
    }

    function encryptHillCipher(){
      var hasil       = document.getElementById('hasilEnkripsiHillCipher');
      var rawPlain    = document.forms["formEncryptHillCipher"]["plainHillCipher"].value.toUpperCase();
      var key00       = document.forms["formEncryptHillCipher"]["key00"].value;
      var key01       = document.forms["formEncryptHillCipher"]["key01"].value;
      var key10       = document.forms["formEncryptHillCipher"]["key10"].value;
      var key11       = document.forms["formEncryptHillCipher"]["key11"].value;
      var plain       = rawPlain.split(' ').join('');
      var plainLength = plain.length;
      plain           = plain.split('');
      cipher          = '';

      if(plainLength % 2 == 1){
        var baris = (plainLength + 1) / 2;
      }
      else{
        var baris = plainLength / 2;
      }
      var key = [];
      key.push([key00,key01]);
      key.push([key10,key11]);

      var pengganti = hurufKeAngka('X');
      if(cekMatrik(2,key)){
        var arrayPlain = [];
        for(i = 0; i < plainLength; i++){
          if(i == plainLength-1){
            if(plainLength % 2 == 1){
              arrayPlain.push([hurufKeAngka(plain[i]),pengganti]);
            }
            else{
              arrayPlain.push([hurufKeAngka(plain[i]),hurufKeAngka(plain[i+1])]);
            }
          }
          else{
            arrayPlain.push([hurufKeAngka(plain[i]),hurufKeAngka(plain[i+1])]);
          }
          i++;
        }

        var change = perkalianMatrik(baris,arrayPlain,key);
        for(i = 0; i < baris; i++){
          for(j = 0; j < 2; j++){
            cipher += (arrayAlfabet[change[i][j] % 26]);
          }
        }
        hasil.innerHTML = cipher;
      }
      else{
        alert('Matrik bukam modular multiplicative inverse');
      }
    }

    function decryptHillCipher(){
      var hasil        = document.getElementById('hasilDekripsiHillCipher');
      var rawCipher    = document.forms["formDecryptHillCipher"]["cipherHillCipher"].value.toUpperCase();
      var key00        = document.forms["formDecryptHillCipher"]["key00"].value;
      var key01        = document.forms["formDecryptHillCipher"]["key01"].value;
      var key10        = document.forms["formDecryptHillCipher"]["key10"].value;
      var key11        = document.forms["formDecryptHillCipher"]["key11"].value
      var cipher       = rawCipher.split(' ').join('');
      var arrayCipher  = cipher.split('');
      var cipherLength = cipher.length;
      var change       = [];
      var key          = [];
      var plain        = '';
      var baris;
      key.push([key00,key01]);
      key.push([key10,key11]);

      baris = cipherLength / 2;

      if(cekMatrik(2,key)){
        for(i = 0; i < cipherLength; i++){
          change.push([hurufKeAngka(arrayCipher[i]),hurufKeAngka(arrayCipher[i+1])]);
          i++;
        }

        var inversmod = inversModulo(key);
        var change2plain = perkalianMatrik(baris,change,inversmod);
        for(i = 0; i < baris; i++){
          for(j = 0; j < 2; j++){
            plain += (arrayAlfabet[change2plain[i][j] % 26]);
          }
        }
        hasil.innerHTML = plain;
      }
      else{
        alert('Matrik x invers matrik harus sama dengan 1')
      }
    }

    function inputKunci(val,id){
      var td = document.getElementById(id);
      var el = '';
      for (var i = 1; i <= val; i++){
        if(i == val){
          el += '<input class="matrik" type="text" name="key[]" pattern="[0-9]*" required>';
        }
        else{
          el += '<input class="matrik" type="text" name="key[]" pattern="[0-9]*" required> - ';
        }
      }
      td.innerHTML = el;
    }

    function encryptTransposisi(){
      var hasil       = document.getElementById('hasilEnkripsiTransposisi');
      var form        = document.forms["formEncryptTransposisi"];
      var rawPlain    = form.elements["plainTransposisi"].value.toUpperCase();
      var key         = form["key[]"];

      var plain       = rawPlain.split(' ').join('');
      var plainLength = plain.length;
      var arrayPlain  = plain.split('');

      var arrayKey    = [];
      var kolom       = key.length;
      var baris       = Math.ceil(plainLength / kolom);
      var arr         = new Array(baris);
      var pos         = 0;
      var cipher      = '';

      for (var i = 0; i < key.length; i++){
        arrayKey.push(key[i].value);
      }

      for (var i = 0; i < baris; i++){
        arr[i] = new Array(kolom);
      }

      for (var i = 0; i < baris; i++){
        for(var j = 0; j < kolom; j++){
          if(pos < plainLength){
            arr[i][j] = arrayPlain[pos];
          }
          else{
            arr[i][j] = 'X';
          }
          pos++;
        }
      }

      for (var i = 0; i < kolom; i++){
        for (var j = 0; j < baris; j++){
          var kol = arrayKey[i] - 1;
          cipher += arr[j][kol];
        }
      }

      hasil.innerHTML = cipher;
    }

    function decryptTransposisi(){
      var hasil        = document.getElementById('hasilDekripsiTransposisi');
      var form         = document.forms["formDecryptTransposisi"];
      var rawCipher    = form.elements["cipherTransposisi"].value.toUpperCase();
      var key          = form["key[]"];

      var cipher       = rawCipher.split(' ').join('');
      var cipherLength = cipher.length;
      var arrayCipher  = cipher.split('');

      var arrayKey     = [];
      var baris        = key.length;
      var kolom        = Math.ceil(cipherLength / baris);
      var arr          = new Array(baris);
      var arr2         = new Array(baris);
      var pos          = 0;
      var plain        = '';

      for (var i = 0; i < key.length; i++){
        arrayKey.push(key[i].value);
      }

      for (var i = 0; i < baris; i++){
        arr[i]  = new Array(kolom);
        arr2[i] = new Array(kolom);
      }

      for (var i = 0; i < baris; i++){
        for (var j = 0; j < kolom; j++){
          arr[i][j] = arrayCipher[pos];
          pos++;
        }
      }

      for (var i = 0; i < baris; i++){
        for (var j = 0; j < kolom; j++){
          var bar   = arrayKey.indexOf(''+(i+1));
          arr2[i][j] = arr[bar][j];
          pos++;
        }
      }

      for (var i = 0; i < kolom; i++){
        for (var j = 0; j < baris; j++){
          plain += arr2[j][i];
        }
      }

      hasil.innerHTML = plain;
    }
    </script>

  </body>
</html>
